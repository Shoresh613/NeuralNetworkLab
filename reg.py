import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

values_direct = [
    105,
    120,
    50,
    210,
    280,
    185,
    80,
    110,
    105,
    105,
    275,
    90,
    285,
    160,
    355,
    210,
    490,
    225,
    110,
    100,
    210,
    110,
    35,
    95,
    65,
    65,
    170,
    335,
    60,
    210,
    10,
    265,
    225,
    225,
    210,
    135,
    135,
    230,
    35,
    35,
    285,
    45,
    75,
    60,
    215,
    125,
    90,
    170,
    20,
    50,
    140,
    15,
    125,
    280,
    50,
    120,
    110,
    135,
    45,
    55,
    120,
    155,
    50,
    110,
    440,
    455,
    535,
    110,
    75,
    170,
    90,
    410,
    120,
    230,
    255,
    125,
    170,
    210,
    210,
    80,
    345,
    105,
    210,
    285,
    100,
    150,
    215,
    150,
    170,
    75,
    155,
    360,
    155,
    375,
    110,
    180,
    200,
    135,
    145,
    195,
    110,
    210,
    60,
    55,
    170,
    120,
    45,
    285,
    120,
    380,
    550,
    60,
    110,
    80,
    195,
    155,
    135,
    180,
    185,
    155,
    155,
    50,
    120,
    240,
    120,
    110,
    125,
    210,
    75,
    210,
    95,
    55,
    105,
    245,
    525,
    65,
    55,
    25,
    80,
    200,
    315,
    80,
    55,
    210,
    210,
    185,
    210,
    45,
    135,
    110,
    210,
    190,
    180,
    100,
    225,
    130,
    230,
    105,
    415,
    305,
    95,
    155,
    100,
    185,
    155,
    230,
    105,
    160,
    190,
    110,
    110,
    20,
    175,
    530,
    210,
    75,
    140,
    50,
    135,
    90,
    400,
    210,
    65,
    210,
    160,
    50,
    155,
    155,
    105,
    155,
    100,
    135,
    110,
    75,
    120,
    75,
    70,
    55,
    120,
    110,
    120,
    35,
    105,
    140,
    145,
    90,
    45,
    55,
    30,
    110,
    90,
    135,
    225,
    110,
    80,
    180,
    410,
    445,
    120,
    135,
    40,
    120,
    170,
    165,
    20,
    70,
    30,
    125,
    185,
    155,
    60,
    80,
    310,
    170,
    105,
    260,
    135,
    55,
    120,
    315,
    215,
    5,
    30,
    85,
    120,
    105,
    50,
    100,
    105,
    50,
    105,
    120,
    55,
    105,
    105,
    135,
    105,
    30,
    150,
    175,
    15,
    30,
    135,
    135,
    135,
    75,
    110,
    110,
    180,
    210,
    430,
    210,
    135,
    170,
    425,
    110,
    335,
    105,
    120,
    335,
    105,
    75,
    50,
    195,
    110,
    105,
    185,
    110,
    75,
    160,
    180,
    120,
    195,
    155,
    80,
    105,
    140,
    105,
    75,
    180,
    50,
    210,
    140,
    135,
    155,
    105,
    105,
    465,
    105,
    120,
    155,
    120,
    170,
    210,
    240,
    210,
    240,
    85,
    65,
    65,
    5,
    80,
    155,
    40,
    315,
    105,
    175,
    75,
    465,
    210,
    135,
    110,
    75,
    80,
    145,
    95,
    75,
    135,
    40,
    160,
    50,
    255,
    155,
    180,
    150,
    215,
    110,
    125,
    65,
    95,
    135,
    110,
    545,
    210,
    80,
    410,
    75,
    95,
    210,
    120,
    120,
    210,
    150,
    50,
    285,
    225,
    120,
    75,
    75,
    185,
    210,
    35,
    165,
    30,
    610,
    55,
    80,
    300,
    85,
    180,
    185,
    175,
    345,
    50,
    90,
    135,
    120,
    140,
    80,
    125,
    130,
    25,
    260,
    320,
    80,
    195,
    150,
    155,
    260,
    60,
    105,
    110,
    130,
    495,
    130,
    285,
    45,
    105,
    310,
    65,
    80,
    215,
    210,
    185,
    80,
    105,
    260,
    135,
    80,
    105,
    425,
    45,
    135,
    180,
    160,
    35,
    10,
    210,
    160,
    135,
    235,
    80,
    90,
    410,
    70,
    145,
    120,
    185,
    210,
    290,
    210,
    125,
    135,
    35,
    180,
    105,
    20,
    110,
    80,
    110,
    55,
    240,
    145,
    80,
    70,
    310,
    195,
    125,
    130,
    155,
    245,
    225,
    120,
    150,
    215,
    60,
    50,
    80,
    55,
    55,
    155,
    135,
    45,
    80,
    805,
    400,
    210,
    230,
    125,
    210,
    180,
    95,
    120,
    135,
    40,
    195,
    140,
    215,
    170,
    95,
    150,
    95,
    120,
    75,
    45,
    325,
    185,
    105,
    50,
    210,
    240,
    225,
    405,
    235,
    185,
    5,
    130,
    50,
    20,
    120,
    60,
    65,
    320,
    225,
    35,
    215,
    165,
    215,
    210,
    70,
    215,
    135,
    80,
    150,
    85,
    180,
    80,
    110,
    120,
    210,
    135,
    100,
    120,
    160,
    155,
    180,
    80,
    80,
    160,
    210,
    170,
    180,
    215,
    145,
    70,
    30,
    50,
    110,
    210,
    55,
    210,
    105,
    105,
    155,
    200,
    120,
    130,
    290,
    80,
    215,
    80,
    455,
    80,
    125,
    85,
    105,
    135,
    80,
    90,
    210,
    70,
    65,
    90,
    90,
    135,
    85,
    400,
    160,
    80,
    35,
    85,
    450,
    80,
    335,
    290,
    65,
    255,
    135,
    105,
    145,
    135,
    70,
    115,
    135,
    90,
    210,
    70,
    75,
    130,
    335,
    550,
    210,
    660,
    145,
    75,
    295,
    180,
    150,
    220,
    230,
    65,
    185,
    150,
    110,
    85,
    245,
]

indices_direct = np.arange(len(values_direct))

slope_direct, intercept_direct, r_value_direct, _, _ = linregress(
    indices_direct, values_direct
)

regression_line_direct = slope_direct * indices_direct + intercept_direct
avg_direct = np.mean(values_direct) * np.ones_like(indices_direct)

plt.figure(figsize=(10, 6))
plt.scatter(indices_direct, values_direct, alpha=0.7, label="Actual Data")
plt.plot(
    indices_direct,
    regression_line_direct,
    color="red",
    label=f"Trend (slope={slope_direct:.4f})",
)
plt.plot(
    indices_direct,
    avg_direct,
    color="blue",
    label=f"Average ({avg_direct[0]:.1f})",
)
plt.xlabel("Episode")
plt.ylabel("Score")
plt.title("100 Episodes w/ Batch Normalization and Additional Layers")
plt.legend()
plt.show()

print(f"Slope: {slope_direct}, RÂ²: {r_value_direct**2}")
